// kwente.js - url here
'use strict';KWENTE.drawing2D={};KWENTE.drawing=KWENTE.drawing2D;KWENTE.drawing2D.sketch=function(a){a=KWENTE.ensureDefaults(a,{scene:null,origin:new KWENTE.drawing2D.shapes.point({x:0,y:0,z:0}),nodes:{relationshipIndicators:[]},grid:{show:!0,x:5,y:5},geometryList:[]});a.scene||console.error("KWENTE.drawing2D.sketch needs a valid scene!!",a.scene);this.scene=a.scene;this.origin=a.origin;this.grid=a.grid;this.geometryList=a.geometryList;this.drawingMode=null;this.drawingMode_soFar={}};
KWENTE.drawing2D.sketch.prototype.DRAWING_MODE_POINT="P";KWENTE.drawing2D.sketch.prototype.DRAWING_MODE_LINE="L";KWENTE.drawing2D.sketch.prototype.move=function(){};KWENTE.drawing2D.sketch.prototype.drawAxes=function(){this.scene.draw_line({x:0,y:0},{x:5,y:0},{style:{color:"#FF0000"}});this.scene.draw_line({x:0,y:0},{x:0,y:5},{style:{color:"#00FF00"}});this.scene.draw_line({x:0,y:0,z:0},{x:0,y:0,z:5},{style:{color:"#0000FF"}})};
KWENTE.drawing2D.sketch.prototype.draw=function(){this.move({mode:"normalTo"});this.drawAxes();for(var a=0;a<this.geometryList.length;a++)!this.geometryList[a]||!this.geometryList[a].draw?console.error("geometry is not drawable",this.geometryList[a]):this.geometryList[a].draw(this.scene);for(a in this.drawingMode_soFar)this.drawingMode_soFar[a]&&this.drawingMode_soFar[a].draw&&this.drawingMode_soFar[a].draw(this.scene)};KWENTE.drawing2D.sketch.prototype.addGeometry=function(a){this.geometryList.push(a)};
KWENTE.drawing2D.sketch.prototype.changeDrawingMode=function(a){switch(a){case KWENTE.drawing.sketch.prototype.DRAWING_MODE_POINT:this.scene.applyCanvasStyle({cursor:"crosshair"});break;case KWENTE.drawing.sketch.prototype.DRAWING_MODE_LINE:this.scene.applyCanvasStyle({cursor:"crosshair"});break;case null:console.log("Esc? hit, not drawing anymore");this.scene.applyCanvasStyle({cursor:""});this.drawingMode_soFar={};break;default:return console.error("invalid drawing mode, not switching",a),!1}this.drawingMode=
a;return this.drawingMode_soFar={}};
KWENTE.drawing2D.sketch.prototype.handleDrawingModeEvent=function(a,b,c){if(c.keyboard[KWENTE.fui_buttons.ESCAPE])return console.log("escapeh!",c.keyboard[KWENTE.fui_buttons.ESCAPE],c.keyboard,c),this.changeDrawingMode(null),!1;if(!this.drawingMode)return!1;var d=this.scene.translateCoordinate(c.mouse.position);if(this.drawingMode){var e=this.closestPoint(d);if(e.dist2<5*this.scene.coordinateDxDy().dx)this.drawingMode_soFar.snappingPoint=new KWENTE.drawing2D.shapes.point({x:e.pt.x,y:e.pt.y,style:{radius:5,
color:"#FF0000",type:"dot-filled"}}),d.x=e.pt.x,d.y=e.pt.y;else if(this.drawingMode_soFar.snappingPoint)this.drawingMode_soFar.snappingPoint=void 0}switch(this.drawingMode){case KWENTE.drawing2D.sketch.prototype.DRAWING_MODE_POINT:if("pointer"==a&&"up"==b)this.drawingMode_soFar.tempPoint?(this.drawingMode_soFar.tempPoint=new KWENTE.drawing2D.shapes.point({x:d.x,y:d.y}),console.log("mousePoint",d,"fuiState.mouse.position",c.mouse.position),this.addGeometry(this.drawingMode_soFar.tempPoint),this.drawingMode_soFar.tempPoint=
new KWENTE.drawing2D.shapes.point({points:[{x:d.x,y:d.y},{}]})):this.drawingMode_soFar.tempPoint=new KWENTE.drawing2D.shapes.point({x:d.x,y:d.y});if("pointer"==a&&"move"==b&&this.drawingMode_soFar.tempPoint)this.drawingMode_soFar.tempPoint=new KWENTE.drawing2D.shapes.point({x:d.x,y:d.y});break;case KWENTE.drawing2D.sketch.prototype.DRAWING_MODE_LINE:if("pointer"==a&&"up"==b)this.drawingMode_soFar.tempLine&&(this.drawingMode_soFar.tempLine.points[1]=new KWENTE.drawing2D.shapes.point({x:d.x,y:d.y}),
this.addGeometry(this.drawingMode_soFar.tempLine)),this.drawingMode_soFar.tempLine=new KWENTE.drawing2D.shapes.line({points:[{x:d.x,y:d.y},{}]});"pointer"==a&&"move"==b&&this.drawingMode_soFar.tempLine&&(this.drawingMode_soFar.tempLine.points[1]=new KWENTE.drawing2D.shapes.point({x:d.x,y:d.y}));break;default:console.log("default? not sure what to do",this.drawingMode,a,b,c)}};
KWENTE.drawing2D.sketch.prototype.getAllPointsList=function(){var a=[],b;for(b in this.geometryList)if(this.geometryList[b].x)a.push({pt:{x:this.geometryList[b].x,y:this.geometryList[b].y,z:this.geometryList[b].z},geometry:this.geometryList[b]});else if(this.geometryList[b].points)for(var c=0;c<this.geometryList[b].points.length;c++)a.push({pt:{x:this.geometryList[b].points[c].x,y:this.geometryList[b].points[c].y,z:this.geometryList[b].points[c].z},geometry:this.geometryList[b]});return a};
KWENTE.drawing2D.sketch.prototype.closestPoint=function(a){for(var b=this.getAllPointsList(),c=0;c<b.length;c++){var d=a.x-b[c].pt.x,e=a.y-b[c].pt.y;b[c].dist2=d*d+e*e+0}b.sort(function(a,b){return a.dist2-b.dist2});return b.shift()};KWENTE.scene=function(a){KWENTE.ensureDefaults(a,{});this.nodes={canvas:null};this.window={x:{min:-10,max:10},y:{min:-10,max:10},canvas:{width:0,height:0}};this.featureTree=[];this.gui=this.fui=this.openDrawing=null;this.viewMotion={};return this.setup()?this:!1};
KWENTE.scene.prototype.setup=function(a){this.gui=new KWENTE.gui(a);this.context=this.nodes.canvas.getContext("2d");if(!this.context)return console.error("2d context getting failed!",this.context,this.nodes.canvas),!1;this.nodes.canvas.width=this.window.canvas.width=parseInt(document.body.clientWidth-10-50);this.nodes.canvas.height=this.window.canvas.height=parseInt(document.body.clientHeight-10);this.viewSquare();this.fui=new KWENTE.fui({});var b=this;this.fui.registerEvent("pointer","down",function(a,
d){b.fuiHandler_pointer_down(a,d)});this.fui.registerEvent("pointer","up",function(a,d){b.fuiHandler_pointer_up(a,d)});this.fui.registerEvent("pointer","move",function(a,d){b.fuiHandler_pointer_move(a,d)});this.fui.registerEvent("pointer","scroll",function(a,d){b.fuiHandler_pointer_scroll(a,d)});this.fui.registerEvent("button","down",function(a,d){b.fuiHandler_button_down(a,d)});this.fui.registerEvent("button","up",function(a,d){b.fuiHandler_button_up(a,d)});this.animationCallback();return!0};
KWENTE.scene.prototype.draw_point=function(a,b){var b=KWENTE.ensureDefaults(b,{color:"#000000",radius:3,type:"*"}),c=this.translatePoint(a),d=this.context;switch(b.type){case "dot-hollow":d.beginPath();d.arc(c.x,c.y,b.radius,0,2*Math.PI,!0);d.closePath();d.strokeStyle=b.color;d.stroke();break;case "dot":case "dot-filled":d.beginPath();d.arc(c.x,c.y,b.radius,0,2*Math.PI,!0);d.closePath();d.fillStyle=b.color;d.fill();break;default:this.draw_line({x:c.x-5,y:c.y},{x:c.x+5,y:c.y},{dontTranslate:!0}),this.draw_line({x:c.x-
3,y:c.y-4},{x:c.x+3,y:c.y+4},{dontTranslate:!0}),this.draw_line({x:c.x-3,y:c.y+4},{x:c.x+3,y:c.y-4},{dontTranslate:!0})}};KWENTE.scene.prototype.draw_line=function(a,b,c){var c=KWENTE.ensureDefaults(c,{style:{color:"#000000"}}),d=this.context;if(!c||!c.dontTranslate)a=this.translatePoint(a),b=this.translatePoint(b);d.beginPath();d.lineWidth=1;d.strokeStyle=c.style.color;d.moveTo(a.x,a.y);d.lineTo(b.x,b.y);d.stroke();d.closePath()};
KWENTE.scene.prototype.translatePoint=function(a){if(!a||!a.x&&0!=a.x||!a.y&&0!=a.y)return!1;var b=(1-(a.y-this.window.y.min)/(this.window.y.max-this.window.y.min))*this.window.canvas.height;return{x:parseInt((a.x-this.window.x.min)/(this.window.x.max-this.window.x.min)*this.window.canvas.width),y:parseInt(b)}};
KWENTE.scene.prototype.translateCoordinate=function(a){if(!a)return console.error("no coordinate supplied",a),!1;var b=a.mouse&&a.mouse.position||a;return!b.x&&0!=b.x||!b.y&&0!=b.y?(console.error("attempting to find point of nothing",b,a),!1):{x:(this.window.x.max-this.window.x.min)*b.x/this.window.canvas.width+this.window.x.min,y:(1-b.y/this.window.canvas.height)*(this.window.y.max-this.window.y.min)+this.window.y.min}};
KWENTE.scene.prototype.editDrawing=function(a){a.scene=this;this.featureTree.push(this.openDrawing=new KWENTE.drawing2D.sketch(a));console.log("editDrawing, new one:",this.openDrawing.constructor,this.openDrawing)};KWENTE.scene.prototype.addToDrawing=function(a,b){return(!b||!b.which)&&!this.openDrawing?(console.error("must specify a drawing to add to",b),!1):this.openDrawing.addGeometry(a)};
KWENTE.scene.prototype.redraw=function(a){a=a||{};a.complete&&this.context.clearRect(0,0,this.nodes.canvas.width,this.nodes.canvas.height);for(a=0;a<this.featureTree.length;a++)!this.featureTree[a]||!this.featureTree[a].draw?console.error("feature is not drawable",this.featureTree[a]):this.featureTree[a].draw()};KWENTE.scene.prototype.animationCallback=function(){this.redraw({complete:!0});var a=this;window.requestAnimationFrame(function(){a.animationCallback()})};
KWENTE.scene.prototype.applyCanvasStyle=function(a){for(var b in a)void 0!=this.nodes.canvas.style[b]&&(this.nodes.canvas.style[b]=a[b])};KWENTE.scene.prototype.adjustCoordinate=function(a){a.x-=this.nodes.canvas.offsetLeft;a.y-=this.nodes.canvas.offsetTop;return a};KWENTE.scene.prototype.getAdjustedCoordinate=function(a){return{x:a.x-this.nodes.canvas.offsetLeft,y:a.y-this.nodes.canvas.offsetTop}};
KWENTE.scene.prototype.viewMove=function(a){var b,c,a=a||{};if(a.to&&a.to.x&&a.to.y)if("number"==typeof a.to.x.mid&&"number"==typeof a.to.y.mid)"number"==typeof a.to.x.span&&"number"==typeof a.to.y.span?(b=a.to.x.span/2,c=a.to.y.span/2):(b=(this.window.x.max-this.window.x.min)/2,c=(this.window.y.max-this.window.y.min)/2),this.window.x.min=a.to.x.mid-b,this.window.x.max=a.to.x.mid+b,this.window.y.min=a.to.y.mid-c,this.window.y.max=a.to.y.mid+c;else if("number"==typeof a.to.x.min&&"number"==typeof a.to.y.min&&
"number"==typeof a.to.x.max&&"number"==typeof a.to.y.max)this.window.x.min=a.to.x.min,this.window.x.max=a.to.x.max,this.window.y.min=a.to.y.min,this.window.y.max=a.to.y.max;a.scale&&"number"==typeof a.scale&&(this.window.x.min*=a.scale,this.window.x.max*=a.scale,this.window.y.min*=a.scale,this.window.y.max*=a.scale);a.translate&&(a.translate.x&&"number"==typeof a.translate.x&&(this.window.x.min+=a.translate.x,this.window.x.max+=a.translate.x),a.translate.y&&"number"==typeof a.translate.y&&(this.window.y.min+=
a.translate.y,this.window.y.max+=a.translate.y),a.translate.z&&"number"==typeof a.translate.z&&(this.window.z.min+=a.translate.z,this.window.z.max+=a.translate.z));a.rotate&&console.error("rotating not supported yet, probably not until the switch to three.js")};
KWENTE.scene.prototype.viewSquare=function(){var a=(this.window.x.max-this.window.x.min)/this.window.canvas.width,b=(this.window.y.max-this.window.y.min)/this.window.canvas.height;if(!(1.0E-5>Math.abs(a-b)))a>b?(b=(this.window.y.max+this.window.y.min)/2,a=a*this.window.canvas.height/2,this.window.y.min=b-a,this.window.y.max=b+a):(a=(this.window.x.max+this.window.x.min)/2,b=b*this.window.canvas.width/2,this.window.x.min=a-b,this.window.x.max=a+b)};
KWENTE.scene.prototype.coordinateDiffPointDiff=function(a){return{x:a.x*((this.window.x.max-this.window.x.min)/this.window.canvas.width),y:a.y*-((this.window.y.max-this.window.y.min)/this.window.canvas.height)}};KWENTE.scene.prototype.coordinateDxDy=function(){return{dx:(this.window.x.max-this.window.x.min)/this.window.canvas.width,dy:(this.window.y.max-this.window.y.min)/this.window.canvas.height}};
KWENTE.scene.prototype.fuiHandler_pointer_down=function(a){var b=KWENTE.copy(a);this.adjustCoordinate(b.mouse.position);a.keyboard.shift?(this.viewMotion.panBasePointReq=this.fui.requestBasePoint(),this.viewMotion.panBasePoint={x:(this.window.x.max+this.window.x.min)/2,y:(this.window.y.max+this.window.y.min)/2}):this.openDrawing.handleDrawingModeEvent("pointer","down",b)};
KWENTE.scene.prototype.fuiHandler_pointer_up=function(a){var b=KWENTE.copy(a);this.adjustCoordinate(b.mouse.position);if(!a.keyboard.was[KWENTE.fui_buttons.SHIFT]){if(this.viewMotion.panBasePointReq)this.fui.releaseBasePoint(this.viewMotion.panBasePointReq),this.viewMotion.panBasePointReq=void 0;this.openDrawing.handleDrawingModeEvent("pointer","up",b)}};
KWENTE.scene.prototype.fuiHandler_pointer_move=function(a){var b=KWENTE.copy(a);this.adjustCoordinate(b.mouse.position);a.keyboard.shift?this.viewMotion.panBasePointReq&&(a=this.coordinateDiffPointDiff(this.fui.basePointMovement(this.viewMotion.panBasePointReq)),this.viewMove({to:{x:{mid:this.viewMotion.panBasePoint.x},y:{mid:this.viewMotion.panBasePoint.y}},translate:{x:-a.x,y:-a.y}})):this.openDrawing.handleDrawingModeEvent("pointer","move",b)};
KWENTE.scene.prototype.fuiHandler_pointer_scroll=function(a){var b=KWENTE.copy(a);this.adjustCoordinate(b.mouse.position);a.keyboard.shift||(this.viewMove({scale:0<b.mouse.dz?0.95:1.05}),this.openDrawing.handleDrawingModeEvent("pointer","scroll",b))};KWENTE.scene.prototype.fuiHandler_button_down=function(a){var b=KWENTE.copy(a);this.adjustCoordinate(b.mouse.position);a.keyboard.shift&&this.applyCanvasStyle({cursor:"move"});this.openDrawing.handleDrawingModeEvent("button","down",b)};
KWENTE.scene.prototype.fuiHandler_button_up=function(a){var b=KWENTE.copy(a);this.adjustCoordinate(b.mouse.position);if(a.keyboard.was[KWENTE.fui_buttons.SHIFT]&&"move"==this.nodes.canvas.style.cursor)this.applyCanvasStyle({cursor:""}),this.fui.releaseBasePoint(this.viewMotion.panBasePointReq),this.viewMotion.panBasePointReq=void 0;this.openDrawing.handleDrawingModeEvent("button","up",b)};var KWENTE=KWENTE||{REVISION:1};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};self.Int32Array=self.Int32Array||Array;self.Float32Array=self.Float32Array||Array;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};
KWENTE.extend=function(a,b){if(Object.keys)for(var c=Object.keys(b),d=0,e=c.length;d<e;d++){var f=c[d];Object.defineProperty(a,f,Object.getOwnPropertyDescriptor(b,f))}else for(f in c={}.hasOwnProperty,b)c.call(b,f)&&(a[f]=b[f]);return a};var console=console||window.console||self.console;window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;
KWENTE.ensureDefaults=function(a,b){if(!b||"object"!=typeof b)return a;for(var c in a)b[c]=KWENTE.ensureDefaults(a[c],b[c]);return b};KWENTE.copy=function(a){var b=null;if("object"==typeof a){var b={},c;for(c in a)b[c]=KWENTE.copy(a[c])}else b=a;return b};KWENTE.fui=function(a){this.states={mouse:{left:!1,right:!1,middle:!1,position:{x:null,y:null}},keyboard:{ctrl:!1,shift:!1,alt:!1,meta:!1,was:{}}};this.options=KWENTE.ensureDefaults(a,{disableContextMenu:!0,debug:10});this.registeredEvents={pointer:{up:[],down:[],move:[],scroll:[]},button:{up:[],down:[]}};this.basePoints={};this.lastKeyDown=null;this.init()};KWENTE.fui.prototype.init=function(){this.attachListeners()};
KWENTE.fui.prototype.attachListeners=function(){var a=this;document.body.addEventListener("mousedown",function(b){a.__listener_mouse_down(b)},!1);document.body.addEventListener("mouseup",function(b){a.__listener_mouse_up(b)},!1);document.body.addEventListener("mousemove",function(b){a.__listener_mouse_move(b)},!1);document.body.addEventListener("mousewheel",function(b){a.__listener_mouse_scroll(b)},!1);document.body.addEventListener("DOMMouseScroll",function(b){a.__listener_mouse_scroll(b)},!1);document.addEventListener("keydown",
function(b){a.__listener_key_down(b)},!1);document.addEventListener("keyup",function(b){a.__listener_key_up(b)},!1);this.options.disableContextMenu=this.options.disableContextMenu||!1;if(this.options.disableContextMenu)document.oncontextmenu=function(a){a&&a.stopPropagation&&a.stopPropagation();return!1};this.options.moveTimer=this.options.moveTimer||250};
KWENTE.fui.prototype.__listener_mouse_down=function(a){this.__commonHandler_modifierKeys(a);this.__commonHandler_mouseButton(a,!0);this.__commonHandler_mousePosition(a);this.options.debug&&2>=this.options.debug&&console.log("mouse down",a,this.states.mouse);this.callEvents("pointer","down")};
KWENTE.fui.prototype.__listener_mouse_up=function(a){this.__commonHandler_modifierKeys(a);this.__commonHandler_mouseButton(a,!1);this.__commonHandler_mousePosition(a);this.options.debug&&2>=this.options.debug&&console.log("mouse up",a,this.states.mouse);this.callEvents("pointer","up")};KWENTE.fui.prototype.__listener_mouse_move=function(a){this.__commonHandler_modifierKeys(a);this.__commonHandler_mousePosition(a);this.callEvents("pointer","move")};
KWENTE.fui.prototype.__listener_mouse_scroll=function(a){this.__commonHandler_modifierKeys(a);this.options.debug&&2>=this.options.debug&&console.log("mouse scroll",a,this.states.mouse);this.states.mouse.dz=-1*Math.max(-1,Math.min(1,a.wheelDelta||-a.detail));this.callEvents("pointer","scroll");this.states.mouse.dz=0};
KWENTE.fui.prototype.__listener_key_down=function(a){if(this.lastKeyDown==a.which)return!1;this.lastKeyDown=a.which;this.__commonHandler_modifierKeys(a);this.__commonHandler_keyIdentification(a,"down");this.options.debug&&2>=this.options.debug&&console.log("key down",a,this.states.keyboard);this.callEvents("button","down")};
KWENTE.fui.prototype.__listener_key_up=function(a){if(this.lastKeyDown==a.which)this.lastKeyDown=null;this.__commonHandler_modifierKeys(a);this.__commonHandler_keyIdentification(a,"up");this.options.debug&&2>=this.options.debug&&console.log("key up",a,this.states.keyboard);this.callEvents("button","up")};
KWENTE.fui.prototype.__commonHandler_modifierKeys=function(a){this.states.keyboard.ctrl=void 0!=a.ctrlKey?a.ctrlKey:this.states.keyboard.ctrl;this.states.keyboard.shift=void 0!=a.shiftKey?a.shiftKey:this.states.keyboard.shift;this.states.keyboard.alt=void 0!=a.altKey?a.altKey:this.states.keyboard.alt;this.states.keyboard.meta=void 0!=a.metaKey?a.metaKey:this.states.keyboard.meta};
KWENTE.fui.prototype.__commonHandler_mouseButton=function(a,b){var c=null;switch(a.which){case 1:c="left";break;case 2:c="middle";break;case 3:c="right";break;default:c="aux"+a.which}this.states.mouse[c]=b};KWENTE.fui.prototype.__commonHandler_mousePosition=function(a){this.states.mouse.position.x=a.clientX;this.states.mouse.position.y=a.clientY};
KWENTE.fui.prototype.__commonHandler_keyIdentification=function(a,b){KWENTE.fui_button_table[a.which]?("up"==b&&(this.states.keyboard.was[KWENTE.fui_button_table[a.which]]=this.states.keyboard[KWENTE.fui_button_table[a.which]]),this.states.keyboard[KWENTE.fui_button_table[a.which]]="down"==b?a.timestamp||Date.now():void 0):console.error("key pressed that is not in the translation table!!!",a.which,a)};
KWENTE.fui.prototype.registerEvent=function(a,b,c){if(!a&&b&&c)return console.error("must supply all arguments to register an event,",a,b,c),!1;if("function"!=typeof c)return console.error("func must be a function,",c),!1;this.registeredEvents[a]||(console.warn("fuiType not recognized (expected 'pointer' or 'button'),",a),this.registeredEvents[a]={});if(!this.registeredEvents[a][b]||this.registeredEvents[a][b].constructor!==[].constructor)console.warn("eventName not recognized or new fuiType,",b),
this.registeredEvents[a][b]=[];return this.registeredEvents[a][b].push(c)-1};KWENTE.fui.prototype.callEvents=function(a,b){var c=this.registeredEvents[a]&&this.registeredEvents[a][b];if(!c)return console.error("unknown event types attempted to be called,",a,b),!1;for(var d=0,e=0;e<c.length;e++)c[e](this.states,this),d++;this.states.mouse.was={};this.states.keyboard.was={};return d};
KWENTE.fui.prototype.requestBasePoint=function(){var a=null;do a=parseInt(1E8*Math.random());while(this.basePoints[a]);this.basePoints[a]={x:this.states.mouse.position.x,y:this.states.mouse.position.y};return a};KWENTE.fui.prototype.releaseBasePoint=function(a){this.basePoints[a]=void 0};KWENTE.fui.prototype.getBasePoint=function(a){return!this.basePoints[a]?(console.error("invalid base point index",a),!1):this.basePoints[a]};
KWENTE.fui.prototype.basePointMovement=function(a){return!this.basePoints[a]?(console.error("invalid base point index",a),!1):{x:this.states.mouse.position.x-this.basePoints[a].x,y:this.states.mouse.position.y-this.basePoints[a].y}};
KWENTE.fui_buttons={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:15,CONTROL:17,ALT:18,ESCAPE:27,SPACE:32,APOSTROPHE:39,ASTERISK:42,PLUS_SIGN:43,COMMA:44,HYPHEN_MINUS:45,FULL_STOP:46,PERIOD:46,SOLIDUS:47,SLASH:47,FORWARD_SLASH:47,DIGIT_ZERO:48,"0":48,DIGIT_ONE:49,1:49,DIGIT_TWO:50,2:50,DIGIT_THREE:51,3:51,DIGIT_FOUR:52,4:52,DIGIT_FIVE:53,5:53,DIGIT_SIX:54,6:54,DIGIT_SEVEN:55,7:55,DIGIT_EIGHT:56,8:56,DIGIT_NINE:57,9:57,SEMICOLON:59,EQUALS_SIGN:61,EQUALS:61,LATIN_CAPITAL_LETTER_A:65,A:65,LATIN_CAPITAL_LETTER_B:66,
B:66,LATIN_CAPITAL_LETTER_C:67,C:67,LATIN_CAPITAL_LETTER_D:68,D:68,LATIN_CAPITAL_LETTER_E:69,E:69,LATIN_CAPITAL_LETTER_F:70,F:70,LATIN_CAPITAL_LETTER_G:71,G:71,LATIN_CAPITAL_LETTER_H:72,H:72,LATIN_CAPITAL_LETTER_I:73,I:73,LATIN_CAPITAL_LETTER_J:74,J:74,LATIN_CAPITAL_LETTER_K:75,K:75,LATIN_CAPITAL_LETTER_L:76,L:76,LATIN_CAPITAL_LETTER_M:77,M:77,LATIN_CAPITAL_LETTER_N:78,N:78,LATIN_CAPITAL_LETTER_O:79,O:79,LATIN_CAPITAL_LETTER_P:80,P:80,LATIN_CAPITAL_LETTER_Q:81,Q:81,LATIN_CAPITAL_LETTER_R:82,R:82,
LATIN_CAPITAL_LETTER_S:83,S:83,LATIN_CAPITAL_LETTER_T:84,T:84,LATIN_CAPITAL_LETTER_U:85,U:85,LATIN_CAPITAL_LETTER_V:86,V:86,LATIN_CAPITAL_LETTER_W:87,W:87,LATIN_CAPITAL_LETTER_X:88,X:88,LATIN_CAPITAL_LETTER_Y:89,Y:89,LATIN_CAPITAL_LETTER_Z:90,Z:90,LEFT_SQUARE_BRACKET:91,REVERSE_SOLIDUS:92,BACKSLASH:92,RIGHT_SQUARE_BRACKET:93,GRAVE_ACCENT:96,DELETE:127,F1:65537,F2:65538,F3:65539,F4:65540,F5:65541,F6:65542,F7:65543,F8:65544,F9:65545,F10:65546,F11:65547,F12:65548,F13:65549,F14:65550,F15:65551,F16:65552,
F17:65553,F18:65554,F19:65555,F20:65556,F21:65557,F22:65558,F23:65559,F24:65560,PAUSE_BREAK:65561,CAPS_LOCK:65562,PAGE_UP:65563,PAGE_DOWN:65564,END:65565,HOME:65566,ARROW_LEFT:65567,ARROW_UP:65568,ARROW_RIGHT:65569,ARROW_DOWN:65570,PRINT_SCREEN:65571,INSERT:65572,OS:65574,CONTEXT_MENU:65575,NUMBER_LOCK:65576,SCROLL_LOCK:65577,HELP:65578,SELECT:65579,EXECUTE:65580,CLEAR:65581,SEPARATOR:65582};
KWENTE.fui_button_table={3:KWENTE.fui_buttons.PAUSE_BREAK,8:KWENTE.fui_buttons.BACKSPACE,9:KWENTE.fui_buttons.TAB,12:KWENTE.fui_buttons.CLEAR,13:KWENTE.fui_buttons.ENTER,16:KWENTE.fui_buttons.SHIFT,17:KWENTE.fui_buttons.CONTROL,18:KWENTE.fui_buttons.CONTEXT_MENU,19:KWENTE.fui_buttons.PAUSE_BREAK,20:KWENTE.fui_buttons.CAPS_LOCK,27:KWENTE.fui_buttons.ESCAPE,32:KWENTE.fui_buttons.SPACE,33:KWENTE.fui_buttons.PAGE_UP,34:KWENTE.fui_buttons.PAGE_DOWN,35:KWENTE.fui_buttons.END,36:KWENTE.fui_buttons.HOME,
37:KWENTE.fui_buttons.ARROW_LEFT,38:KWENTE.fui_buttons.ARROW_UP,39:KWENTE.fui_buttons.ARROW_RIGHT,40:KWENTE.fui_buttons.ARROW_DOWN,41:KWENTE.fui_buttons.SELECT,43:KWENTE.fui_buttons.EXECUTE,44:KWENTE.fui_buttons.PRINT_SCREEN,45:KWENTE.fui_buttons.INSERT,46:KWENTE.fui_buttons.DELETE,47:KWENTE.fui_buttons.HELP,48:KWENTE.fui_buttons.DIGIT_ZERO,49:KWENTE.fui_buttons.DIGIT_ONE,50:KWENTE.fui_buttons.DIGIT_TWO,51:KWENTE.fui_buttons.DIGIT_THREE,52:KWENTE.fui_buttons.DIGIT_FOUR,53:KWENTE.fui_buttons.DIGIT_FIVE,
54:KWENTE.fui_buttons.DIGIT_SIX,55:KWENTE.fui_buttons.DIGIT_SEVEN,56:KWENTE.fui_buttons.DIGIT_EIGHT,57:KWENTE.fui_buttons.DIGIT_NINE,65:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_A,66:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_B,67:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_C,68:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_D,69:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_E,70:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_F,71:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_G,72:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_H,73:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_I,
74:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_J,75:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_K,76:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_L,77:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_M,78:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_N,79:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_O,80:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_P,81:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_Q,82:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_R,83:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_S,84:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_T,85:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_U,
86:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_V,87:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_W,88:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_X,89:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_Y,90:KWENTE.fui_buttons.LATIN_CAPITAL_LETTER_Z,91:KWENTE.fui_buttons.OS,92:KWENTE.fui_buttons.OS,96:KWENTE.fui_buttons.NUMPAD_0,97:KWENTE.fui_buttons.NUMPAD_1,98:KWENTE.fui_buttons.NUMPAD_2,99:KWENTE.fui_buttons.NUMPAD_3,100:KWENTE.fui_buttons.NUMPAD_4,101:KWENTE.fui_buttons.NUMPAD_5,102:KWENTE.fui_buttons.NUMPAD_6,103:KWENTE.fui_buttons.NUMPAD_7,
104:KWENTE.fui_buttons.NUMPAD_8,105:KWENTE.fui_buttons.NUMPAD_9,106:KWENTE.fui_buttons.NUMPAD_MULTIPLY,107:KWENTE.fui_buttons.NUMPAD_ADD,108:KWENTE.fui_buttons.SEPARATOR,109:KWENTE.fui_buttons.NUMPAD_SUBTRACT,110:KWENTE.fui_buttons.SEPARATOR,111:KWENTE.fui_buttons.NUMPAD_DIVIDE,112:KWENTE.fui_buttons.F1,113:KWENTE.fui_buttons.F2,114:KWENTE.fui_buttons.F3,115:KWENTE.fui_buttons.F4,116:KWENTE.fui_buttons.F5,117:KWENTE.fui_buttons.F6,118:KWENTE.fui_buttons.F7,119:KWENTE.fui_buttons.F8,120:KWENTE.fui_buttons.F9,
121:KWENTE.fui_buttons.F10,122:KWENTE.fui_buttons.F11,123:KWENTE.fui_buttons.F12,124:KWENTE.fui_buttons.F13,125:KWENTE.fui_buttons.F14,126:KWENTE.fui_buttons.F15,127:KWENTE.fui_buttons.F16,128:KWENTE.fui_buttons.F17,129:KWENTE.fui_buttons.F18,130:KWENTE.fui_buttons.F19,131:KWENTE.fui_buttons.F20,132:KWENTE.fui_buttons.F21,133:KWENTE.fui_buttons.F22,134:KWENTE.fui_buttons.F23,135:KWENTE.fui_buttons.F24,144:KWENTE.fui_buttons.NUMBER_LOCK,145:KWENTE.fui_buttons.SCROLL_LOCK,160:KWENTE.fui_buttons.SHIFT,
161:KWENTE.fui_buttons.SHIFT,162:KWENTE.fui_buttons.CONTROL,163:KWENTE.fui_buttons.CONTROL,164:KWENTE.fui_buttons.CONTEXT_MENU,165:KWENTE.fui_buttons.CONTEXT_MENU,254:KWENTE.fui_buttons.CLEAR,187:KWENTE.fui_buttons.PLUS_SIGN,188:KWENTE.fui_buttons.COMMA,189:KWENTE.fui_buttons.HYPHEN_MINUS,190:KWENTE.fui_buttons.PERIOD,186:KWENTE.fui_buttons.SEMICOLON,191:KWENTE.fui_buttons.SOLIDUS,192:KWENTE.fui_buttons.GRAVE_ACCENT,219:KWENTE.fui_buttons.LEFT_SQUARE_BRACKET,220:KWENTE.fui_buttons.REVERSE_SOLIDUS,
221:KWENTE.fui_buttons.RIGHT_SQUARE_BRACKET,222:KWENTE.fui_buttons.APOSTROPHE,59:KWENTE.fui_buttons.SEMICOLON,61:KWENTE.fui_buttons.EQUALS_SIGN,173:KWENTE.fui_buttons.HYPHEN_MINUS,Alt:KWENTE.fui_buttons.ALT,Control:KWENTE.fui_buttons.CONTROL,Shift:KWENTE.fui_buttons.SHIFT,CapsLock:KWENTE.fui_buttons.CAPS_LOCK,Win:KWENTE.fui_buttons.OS,Clear:KWENTE.fui_buttons.CLEAR,Down:KWENTE.fui_buttons.ARROW_DOWN,End:KWENTE.fui_buttons.END,Enter:KWENTE.fui_buttons.ENTER,Execute:KWENTE.fui_buttons.EXECUTE,F1:KWENTE.fui_buttons.F1,
F2:KWENTE.fui_buttons.F2,F3:KWENTE.fui_buttons.F3,F4:KWENTE.fui_buttons.F4,F5:KWENTE.fui_buttons.F5,F6:KWENTE.fui_buttons.F6,F7:KWENTE.fui_buttons.F7,F8:KWENTE.fui_buttons.F8,F9:KWENTE.fui_buttons.F9,F10:KWENTE.fui_buttons.F10,F11:KWENTE.fui_buttons.F11,F12:KWENTE.fui_buttons.F12,F13:KWENTE.fui_buttons.F13,F14:KWENTE.fui_buttons.F14,F15:KWENTE.fui_buttons.F15,F16:KWENTE.fui_buttons.F16,F17:KWENTE.fui_buttons.F17,F18:KWENTE.fui_buttons.F18,F19:KWENTE.fui_buttons.F19,F20:KWENTE.fui_buttons.F20,F21:KWENTE.fui_buttons.F21,
F22:KWENTE.fui_buttons.F22,F23:KWENTE.fui_buttons.F23,F24:KWENTE.fui_buttons.F24,Help:KWENTE.fui_buttons.HELP,Home:KWENTE.fui_buttons.HOME,Insert:KWENTE.fui_buttons.INSERT,Left:KWENTE.fui_buttons.ARROW_LEFT,PageDown:KWENTE.fui_buttons.PAGE_DOWN,PageUp:KWENTE.fui_buttons.PAGE_UP,Pause:KWENTE.fui_buttons.PAUSE_BREAK,PrintScreen:KWENTE.fui_buttons.PRINT_SCREEN,Right:KWENTE.fui_buttons.ARROW_RIGHT,Scroll:KWENTE.fui_buttons.SCROLL_LOCK,Select:KWENTE.fui_buttons.SELECT,Up:KWENTE.fui_buttons.ARROW_UP};KWENTE.gui=function(){console.log("created new gui :)")};KWENTE.drawing2D.shapes={};KWENTE.drawing2D.shapes.line=function(a){a=KWENTE.ensureDefaults(a,{points:[{x:null,y:null,z:null},{x:null,y:null,z:null},{x:null,y:null,z:null}]});this.points=[new KWENTE.drawing2D.shapes.point(a.points[0]),new KWENTE.drawing2D.shapes.point(a.points[1])]};
KWENTE.drawing2D.shapes.line.prototype.draw=function(a){var b={style:{}};b.style.color="#0000AA";a.draw_line(this.points[0],this.points[1],b);a.draw_point(this.points[0],{type:"dot-filled",style:b.style});a.draw_point(this.points[1],{type:"dot-filled",style:b.style});this.points[2]={x:(this.points[0].x+this.points[1].x)/2,y:(this.points[0].y+this.points[1].y)/2};a.draw_point(this.points[2],{type:"dot-hollow",style:b.style})};KWENTE.drawing2D.shapes.point=function(a){a=KWENTE.ensureDefaults(a,{x:null,y:null,z:null,style:{color:"#000000",radius:4,type:"*"}});this.x=a.x;this.y=a.y;this.z=a.z;this.style=a.style};KWENTE.drawing2D.shapes.point.prototype.draw=function(a){a.draw_point(this,this.style)};KWENTE.drawing2D.shapes.point.prototype.distance=function(a){return!a.x||!a.y||!a.z?(console.error("attempting to find distance to non-point: ",a),null):Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z)};
